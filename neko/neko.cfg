#!/usr/bin/env bash

#  ███╗   ██╗███████╗██╗  ██╗ ██████╗      ██████╗ ██████╗ ███╗   ██╗███████╗██╗ ██████╗ 
#  ████╗  ██║██╔════╝██║ ██╔╝██╔═══██╗    ██╔════╝██╔═══██╗████╗  ██║██╔════╝██║██╔════╝ 
#  ██╔██╗ ██║█████╗  █████╔╝ ██║   ██║    ██║     ██║   ██║██╔██╗ ██║█████╗  ██║██║  ███╗
#  ██║╚██╗██║██╔══╝  ██╔═██╗ ██║   ██║    ██║     ██║   ██║██║╚██╗██║██╔══╝  ██║██║   ██║
#  ██║ ╚████║███████╗██║  ██╗╚██████╔╝    ╚██████╗╚██████╔╝██║ ╚████║██║     ██║╚██████╔╝
#  ╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝ ╚═════╝      ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝╚═╝     ╚═╝ ╚═════╝ 
#
# Neko Configuration File
# Enterprise-grade Bug Bounty Automation Framework
# Version: 1.0.0

# ═══════════════════════════════════════════════════════════════════════════════
# GENERAL SETTINGS
# ═══════════════════════════════════════════════════════════════════════════════

# Tools installation path
TOOLS_PATH="${HOME}/Tools"

# Output base directory (leave empty for default: ./output)
OUTPUT_BASE_DIR=""

# User agent for HTTP requests
USER_AGENT="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"

# Proxy settings (leave empty to disable)
PROXY_URL=""
# PROXY_URL="http://127.0.0.1:8080"

# ═══════════════════════════════════════════════════════════════════════════════
# API KEYS AND TOKENS
# ═══════════════════════════════════════════════════════════════════════════════

# GitHub token for github-subdomains, trufflehog, gitleaks
GITHUB_TOKEN=""

# GitLab token
GITLAB_TOKEN=""

# Shodan API key
SHODAN_API_KEY=""

# Censys API credentials
CENSYS_API_ID=""
CENSYS_API_SECRET=""

# VirusTotal API key
VIRUSTOTAL_API_KEY=""

# SecurityTrails API key
SECURITYTRAILS_API_KEY=""

# WhoisXML API key
WHOISXML_API_KEY=""

# Hunter.io API key
HUNTER_API_KEY=""

# Chaos API key (ProjectDiscovery)
CHAOS_API_KEY=""

# Binary Edge API key
BINARYEDGE_API_KEY=""

# ZoomEye API key
ZOOMEYE_API_KEY=""

# Fofa API credentials
FOFA_EMAIL=""
FOFA_KEY=""

# Interactsh server (for OOB testing)
INTERACTSH_SERVER=""
# INTERACTSH_SERVER="oast.pro"

# XSS Hunter URL
XSS_HUNTER_URL=""

# Collaborator server
COLLABORATOR_SERVER=""

# ═══════════════════════════════════════════════════════════════════════════════
# NOTIFICATION SETTINGS
# ═══════════════════════════════════════════════════════════════════════════════

# Enable notifications
NOTIFICATION_ENABLED=false

# Slack webhook URL
SLACK_WEBHOOK=""

# Discord webhook URL
DISCORD_WEBHOOK=""

# Telegram bot configuration
TELEGRAM_BOT_TOKEN=""
TELEGRAM_CHAT_ID=""

# ProjectDiscovery notify config path
NOTIFY_CONFIG="${HOME}/.config/notify/provider-config.yaml"

# ═══════════════════════════════════════════════════════════════════════════════
# PHASE TOGGLES (Enable/Disable Phases)
# ═══════════════════════════════════════════════════════════════════════════════

# Phase 0: OSINT & Intelligence Gathering
OSINT_ENABLED=true
OSINT_WHOIS=true
OSINT_THEHARVESTER=true
OSINT_GITHUB_RECON=true
OSINT_GITLAB_RECON=true
OSINT_TRUFFLEHOG=true
OSINT_GITLEAKS=true
OSINT_PORCH_PIRATE=true
OSINT_SWAGGER_SPY=true
OSINT_GOOGLE_DORKS=true
OSINT_SPOOF_CHECK=true

# Phase 1: Subdomain Discovery
SUBDOMAIN_ENABLED=true
SUB_PASSIVE=true              # Passive enumeration (subfinder, assetfinder)
SUB_AMASS=true                # Amass active enumeration
SUB_CRT=true                  # Certificate transparency
SUB_GITHUB=true               # GitHub subdomain leaks
SUB_BRUTEFORCE=true           # DNS bruteforcing with puredns
SUB_PERMUTATION=true          # Subdomain permutations (gotator, ripgen)
SUB_RECURSIVE=true            # Recursive enumeration
SUB_SCRAPING=true             # Web scraping for subdomains
SUB_TLS=true                  # TLS certificate analysis

# Phase 2: DNS Analysis
DNS_ENABLED=true
DNS_RESOLUTION=true           # Mass DNS resolution
DNS_ZONE_TRANSFER=true        # Zone transfer checks
DNS_RECORDS=true              # Full DNS record enumeration
DNS_REVERSE=true              # Reverse DNS lookups

# Phase 3: Web Probing
WEBPROBE_ENABLED=true
PROBE_HTTPX=true              # HTTPx probing
PROBE_WAF=true                # WAF detection
PROBE_CDN=true                # CDN detection
PROBE_SCREENSHOTS=true        # Web screenshots

# Phase 4: Port Scanning
PORTSCAN_ENABLED=true
SCAN_MASSCAN=true             # Fast port scan with masscan
SCAN_NMAP=true                # Deep service detection with nmap
SCAN_PASSIVE=true             # Passive port scan (Shodan)
SCAN_COMMON_ONLY=false        # Scan only common ports

# Phase 5: Content Discovery
CONTENT_ENABLED=true
FUZZ_FFUF=true                # Directory fuzzing with ffuf
FUZZ_RECURSIVE=true           # Recursive fuzzing
FUZZ_EXTENSIONS=true          # Extension fuzzing
FUZZ_VHOST=true               # Virtual host fuzzing

# Phase 6: Technology Fingerprinting
FINGERPRINT_ENABLED=true
FP_WHATWEB=true               # WhatWeb fingerprinting
FP_NIKTO=true                 # Nikto scanning
FP_WPSCAN=true                # WordPress scanning
FP_CMSEEK=true                # CMS detection
FP_HTTPX_TECH=true            # HTTPx tech detection

# Phase 7: URL & JavaScript Analysis
URLANALYSIS_ENABLED=true
URL_KATANA=true               # Web crawling with katana
URL_GAU=true                  # GetAllUrls
URL_WAYBACK=true              # Wayback machine URLs
URL_JS_ANALYSIS=true          # JavaScript file analysis
URL_SECRETS=true              # Secret detection in JS

# Phase 8: Parameter Discovery
PARAM_ENABLED=true
PARAM_ARJUN=true              # Arjun parameter discovery
PARAM_PARAMSPIDER=true        # ParamSpider mining
PARAM_GF=true                 # GF pattern matching
PARAM_DEDUPE=true             # URL deduplication

# Phase 9: Vulnerability Scanning
VULNSCAN_ENABLED=true
VULN_NUCLEI=true              # Nuclei template scanning
VULN_SQLI=true                # SQL injection testing
VULN_SQLI_SQLMAP=true         # SQLMap for SQLi
VULN_SQLI_GHAURI=true         # Ghauri for SQLi
VULN_COMMIX=true              # Command injection
VULN_SSTI=true                # SSTI testing
VULN_SSRF=true                # SSRF testing
VULN_LFI=true                 # LFI testing
VULN_CRLF=true                # CRLF injection
VULN_CORS=true                # CORS misconfiguration
VULN_OPEN_REDIRECT=true       # Open redirect testing
VULN_HEADERS=true             # Security headers check

# Phase 10: XSS Detection
XSS_ENABLED=true
XSS_DALFOX=true               # Dalfox XSS scanner
XSS_XSSTRIKE=true             # XSStrike scanner
XSS_GXSS=true                 # Gxss reflection check
XSS_KXSS=true                 # Quick XSS check

# Phase 11: Subdomain Takeover
TAKEOVER_ENABLED=true
TAKEOVER_NUCLEI=true          # Nuclei takeover templates
TAKEOVER_DNSREAPER=true       # DNSReaper
TAKEOVER_DNSTAKE=true         # DNSTake
TAKEOVER_SUBJACK=true         # Subjack

# Phase 12: Cloud Security
CLOUD_ENABLED=true
CLOUD_S3=true                 # S3 bucket scanning
CLOUD_AZURE=true              # Azure blob scanning
CLOUD_GCP=true                # GCP bucket scanning
CLOUD_ENUM=true               # Cloud service enumeration

# Phase 13: Authentication Testing
AUTH_ENABLED=false            # Disabled by default (intrusive)
AUTH_BRUTESPRAY=true          # Service bruteforcing
AUTH_JWT=true                 # JWT analysis
AUTH_DEFAULT_CREDS=true       # Default credential checking

# Phase 14: API Security
API_ENABLED=true
API_SWAGGER=true              # Swagger/OpenAPI discovery
API_GRAPHQL=true              # GraphQL endpoint testing
API_ENDPOINTS=true            # API endpoint fuzzing
API_KITERUNNER=true           # API route discovery

# Phase 15: Report Generation
REPORT_ENABLED=true
REPORT_HTML=true              # HTML report
REPORT_MARKDOWN=true          # Markdown report
REPORT_JSON=true              # JSON export
REPORT_SUMMARY=true           # Executive summary

# ═══════════════════════════════════════════════════════════════════════════════
# THREADING CONFIGURATION (Per-tool optimization)
# ═══════════════════════════════════════════════════════════════════════════════

# Subdomain discovery threads
SUBFINDER_THREADS=100
AMASS_THREADS=50
ASSETFINDER_THREADS=50
PUREDNS_THREADS=200

# Web probing threads
HTTPX_THREADS=50
HTTPROBE_THREADS=50

# DNS resolution threads
DNSX_THREADS=150
MASSDNS_THREADS=1000

# Content discovery threads
FFUF_THREADS=50
FEROXBUSTER_THREADS=50
GOBUSTER_THREADS=50

# URL analysis threads
KATANA_THREADS=20
GAU_THREADS=5
WAYBACK_THREADS=5

# Vulnerability scanning threads
NUCLEI_THREADS=25
DALFOX_THREADS=100
SQLMAP_THREADS=5
NMAP_THREADS=10

# Port scanning
MASSCAN_THREADS=1000

# Misc tools
ARJUN_THREADS=20
BRUTESPRAY_THREADS=20

# ═══════════════════════════════════════════════════════════════════════════════
# RATE LIMITING (Requests per second - 0 = unlimited)
# ═══════════════════════════════════════════════════════════════════════════════

# These rate limits help prevent DOS and respect target infrastructure

# Web probing rate limits
HTTPX_RATELIMIT=150
KATANA_RATELIMIT=150

# Fuzzing rate limits
FFUF_RATELIMIT=100
FEROXBUSTER_RATELIMIT=100
GOBUSTER_RATELIMIT=100

# Scanning rate limits
NUCLEI_RATELIMIT=150
DALFOX_RATELIMIT=150

# Port scanning rate limits (packets per second)
MASSCAN_RATE=1000
NMAP_RATE=1000

# DNS rate limits
DNSX_RATELIMIT=0
PUREDNS_PUBLIC_LIMIT=0
PUREDNS_TRUSTED_LIMIT=400

# API/OSINT rate limits
SUBFINDER_RATELIMIT=0
GAU_RATELIMIT=0
WAYBACK_RATELIMIT=0
SHODAN_RATELIMIT=1

# SQLi testing (be careful with this)
SQLMAP_RATELIMIT=10
GHAURI_RATELIMIT=10

# ═══════════════════════════════════════════════════════════════════════════════
# TIMEOUTS (in seconds unless specified)
# ═══════════════════════════════════════════════════════════════════════════════

# HTTP timeouts
HTTPX_TIMEOUT=10
CURL_TIMEOUT=30
WGET_TIMEOUT=30

# Tool-specific timeouts
FFUF_MAXTIME=900              # 15 minutes
NUCLEI_TIMEOUT=30
SQLMAP_TIMEOUT=300            # 5 minutes per URL
NMAP_TIMEOUT=3600             # 1 hour
MASSCAN_TIMEOUT=600           # 10 minutes

# Phase timeouts (in seconds)
OSINT_TIMEOUT=1800            # 30 minutes
SUBDOMAIN_TIMEOUT=3600        # 1 hour
DNS_TIMEOUT=1800              # 30 minutes
WEBPROBE_TIMEOUT=1800         # 30 minutes
PORTSCAN_TIMEOUT=3600         # 1 hour
CONTENT_TIMEOUT=3600          # 1 hour
FINGERPRINT_TIMEOUT=1800      # 30 minutes
URLANALYSIS_TIMEOUT=3600      # 1 hour
VULNSCAN_TIMEOUT=7200         # 2 hours
XSS_TIMEOUT=3600              # 1 hour
TAKEOVER_TIMEOUT=1800         # 30 minutes
CLOUD_TIMEOUT=1800            # 30 minutes

# ═══════════════════════════════════════════════════════════════════════════════
# WORDLISTS AND RESOLVERS
# ═══════════════════════════════════════════════════════════════════════════════

# Subdomain wordlists
SUBS_WORDLIST="${TOOLS_PATH}/wordlists/subdomains.txt"
SUBS_WORDLIST_SMALL="${TOOLS_PATH}/wordlists/subdomains-top1million-5000.txt"
SUBS_WORDLIST_BIG="${TOOLS_PATH}/wordlists/subdomains-top1million-110000.txt"

# Content discovery wordlists
FUZZ_WORDLIST="${TOOLS_PATH}/wordlists/fuzz.txt"
FUZZ_WORDLIST_SMALL="${TOOLS_PATH}/wordlists/common.txt"
FUZZ_WORDLIST_BIG="${TOOLS_PATH}/wordlists/raft-large-directories.txt"

# Specialized wordlists
LFI_WORDLIST="${TOOLS_PATH}/wordlists/lfi.txt"
SQLI_WORDLIST="${TOOLS_PATH}/wordlists/sqli.txt"
SSTI_WORDLIST="${TOOLS_PATH}/wordlists/ssti.txt"
XSS_WORDLIST="${TOOLS_PATH}/wordlists/xss.txt"
API_WORDLIST="${TOOLS_PATH}/wordlists/api-endpoints.txt"
PARAMS_WORDLIST="${TOOLS_PATH}/wordlists/params.txt"

# DNS resolvers
RESOLVERS="${TOOLS_PATH}/resolvers.txt"
RESOLVERS_TRUSTED="${TOOLS_PATH}/resolvers_trusted.txt"

# Resolver URLs for auto-update
RESOLVERS_URL="https://raw.githubusercontent.com/trickest/resolvers/main/resolvers.txt"
RESOLVERS_TRUSTED_URL="https://raw.githubusercontent.com/trickest/resolvers/main/resolvers-trusted.txt"

# ═══════════════════════════════════════════════════════════════════════════════
# NUCLEI CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# Nuclei templates path
NUCLEI_TEMPLATES_PATH="${HOME}/nuclei-templates"

# Custom templates path
NUCLEI_CUSTOM_TEMPLATES="${TOOLS_PATH}/custom-nuclei-templates"

# Severity levels to scan (comma-separated: info,low,medium,high,critical)
NUCLEI_SEVERITY="low,medium,high,critical"
NUCLEI_SEVERITY_FAST="high,critical"

# Tags to exclude (comma-separated)
NUCLEI_EXCLUDE_TAGS="dos,fuzz"

# Additional nuclei flags
NUCLEI_EXTRA_FLAGS="-silent -retries 2"

# Enable headless mode for nuclei
NUCLEI_HEADLESS=false

# ═══════════════════════════════════════════════════════════════════════════════
# NMAP CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# Default nmap flags
NMAP_DEFAULT_FLAGS="-sV -sC -Pn --open"

# Top ports to scan (for fast mode)
NMAP_TOP_PORTS=1000

# Full port range
NMAP_FULL_PORTS="1-65535"

# Common web ports
NMAP_WEB_PORTS="80,443,8080,8443,8000,8888,3000,5000,9000"

# Scripts to run
NMAP_SCRIPTS="vulners,http-enum"

# ═══════════════════════════════════════════════════════════════════════════════
# MASSCAN CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# Default masscan flags
MASSCAN_DEFAULT_FLAGS="--rate ${MASSCAN_RATE:-1000}"

# Ports to scan
MASSCAN_PORTS="0-65535"
MASSCAN_COMMON_PORTS="21,22,23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080,8443"

# ═══════════════════════════════════════════════════════════════════════════════
# FFUF CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# Default ffuf flags
FFUF_DEFAULT_FLAGS="-mc all -fc 404 -sf -noninteractive -of json"

# Recursion depth
FFUF_RECURSION_DEPTH=2

# Extensions to fuzz
FFUF_EXTENSIONS=".php,.asp,.aspx,.jsp,.html,.js,.txt,.xml,.json,.bak,.old,.conf,.config,.sql,.zip,.tar,.gz"

# ═══════════════════════════════════════════════════════════════════════════════
# HTTPX CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# Default httpx flags
HTTPX_DEFAULT_FLAGS="-follow-redirects -random-agent -status-code -silent -title -web-server -tech-detect -location -content-length"

# Ports to probe
HTTPX_PORTS="80,443,8080,8443,8000,8888,3000,5000,9000,9443"

# ═══════════════════════════════════════════════════════════════════════════════
# RESOURCE LIMITS (Enterprise Performance Tuning)
# ═══════════════════════════════════════════════════════════════════════════════

# Maximum concurrent network operations
MAX_NETWORK_PROCS=5

# Maximum concurrent CPU-intensive operations
MAX_CPU_PROCS=4

# Maximum concurrent I/O operations
MAX_IO_PROCS=3

# Memory limit per process (in MB, 0 = unlimited)
MEMORY_LIMIT=0

# ═══════════════════════════════════════════════════════════════════════════════
# DEEP MODE SETTINGS
# ═══════════════════════════════════════════════════════════════════════════════

# Limits before deep mode is required
DEEP_LIMIT=500                # First threshold
DEEP_LIMIT2=1500              # Second threshold

# Deep mode multipliers
DEEP_THREADS_MULTIPLIER=2
DEEP_TIMEOUT_MULTIPLIER=3

# ═══════════════════════════════════════════════════════════════════════════════
# SCOPE SETTINGS
# ═══════════════════════════════════════════════════════════════════════════════

# Use inscope filtering (requires .scope file)
USE_INSCOPE=false

# Out of scope file
OUT_OF_SCOPE_FILE=""

# Exclude CDN IPs from scanning
EXCLUDE_CDN=true

# ═══════════════════════════════════════════════════════════════════════════════
# SCAN PROFILES
# ═══════════════════════════════════════════════════════════════════════════════

# Default profile (recon, aggressive, stealth)
DEFAULT_PROFILE="recon"

# ═══════════════════════════════════════════════════════════════════════════════
# MISCELLANEOUS
# ═══════════════════════════════════════════════════════════════════════════════

# Clean up temporary files after scan
CLEANUP_TEMP=false

# Remove logs after successful scan
CLEANUP_LOGS=false

# Compress output directory after scan
COMPRESS_OUTPUT=false

# Debug mode
DEBUG=false

# Quiet mode (minimal output)
QUIET=false

# Color output
COLOR_OUTPUT=true

# ═══════════════════════════════════════════════════════════════════════════════
# GOLANG AND PATH CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

export GOROOT="${GOROOT:-/usr/local/go}"
export GOPATH="${GOPATH:-$HOME/go}"
export PATH="${GOPATH}/bin:${GOROOT}/bin:${HOME}/.local/bin:${PATH}"
export PATH="${HOME}/.cargo/bin:${PATH}"
